window.customElements.define("kp-modal",class extends HTMLElement{get visible(){return this.hasAttribute("visible")}set visible(t){t?this.setAttribute("visible",""):this.removeAttribute("visible")}static get observedAttributes(){return["visible"]}constructor(){super(),this.attachShadow({mode:"open"}),this.nodes=null}connectedCallback(){this.render(),this.modal=this.shadowRoot.querySelector(".modal"),this.dialog=this.shadowRoot.querySelector(".modal-dialog"),this.closeBtn=this.querySelector(".close"),this.attachEventHandlers()}removeEvents(){this.removeEventListener("kp.modal.opened",this.show,!0),this.removeEventListener("kp.modal.closed",this.close,!0),this.modal.removeEventListener("click",this.close,!0),null!==this.closeBtn&&this.closeBtn.removeEventListener("click",this.close,!0)}disconnectedCallback(){this.removeEvents()}attributeChangedCallback(t,e,s){"visible"===t&&(null===s?this.modal.classList.remove("visible"):this.modal.classList.add("visible"))}render(){const t=document.createElement("div"),e=(new Date).getUTCMilliseconds();t.innerHTML=`<style>:host {--modal-bg-colour: #fff;--modal-colour: #151515;--modal-backdrop: rgba(0, 0, 0, .7);}*, *::after, *::before{box-sizing: border-box;}.modal {position: fixed;top: 0;left: 0;z-index: 50;width: 100%;height: 100%;color: var(--modal-colour);background-color: var(--modal-backdrop);opacity: 0;visibility: hidden;transform: scale(1.1);transition: visibility 0s linear .25s, opacity .25s 0s, transform .25s;}.visible {opacity: 1;visibility: visible;transform: scale(1);transition: visibility 0s linear 0s, opacity .25s 0s, transform .25s;}.modal-dialog {position: absolute;top: 50%;left: 50%;display: flex;width: 80vw;height: 80vh;padding: 1rem;flex-direction: column;background-color: var(--modal-bg-colour);transform: translate(-50%, -50%);border-radius: .2rem;}.modal-content {padding-right: 1rem;margin-bottom: 1rem;overflow-y: auto;}.modal-title {margin-bottom: 1rem;font-size: 1.8rem;}.modal-footer {display: flex;margin-top: auto;justify-content: flex-end;}</style><div class='modal${this.visible?" visible":""}'><div class='modal-dialog' role='document'><slot name='modal-title' class='modal-title' id='modal-title-${e}'></slot><div class='modal-content'><slot name='modal-content' id='modal-desc-${e}'></slot></div><slot name='modal-footer' class='modal-footer'></slot></div></div>`,this.setAttribute("aria-labelledby","modal-title-"+e),this.setAttribute("aria-describedby","modal-desc-"+e),this.setAttribute("aria-modal",!0),this.setAttribute("role","dialog"),this.shadowRoot.appendChild(t)}dispatchCustomEvent(t){const e=new CustomEvent(t,{bubbles:!0,cancelable:!0});e.relatedTarget=this,this.dispatchEvent(e),this.removeEventListener(t,this)}attachEventHandlers(){null!==this.closeBtn&&this.closeBtn.addEventListener("click",()=>{this.close()}),this.modal.addEventListener("click",({target:t})=>{t===this||t===this.dialog||this.dialog.contains(t)||this.contains(t)||this.close()})}keypress(t){"Escape"===t&&this.close()}trap(t){const e=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","[contenteditable]"].join(",");this.nodes=[...document.querySelectorAll(e)].filter(e=>!t.contains(e)&&"-1"!==e.getAttribute("tabindex")),this.nodes.forEach(t=>t.setAttribute("tabindex","-1"))}release(){this.nodes.forEach(t=>t.removeAttribute("tabindex"))}show(){this.visible=!0,this.trap(this),this.dispatchCustomEvent("kp.modal.opened"),document.addEventListener("keyup",({code:t})=>{this.keypress(t)},{once:!0})}close(){this.visible=!1,this.release(),this.dispatchCustomEvent("kp.modal.closed"),this.removeEvents()}});